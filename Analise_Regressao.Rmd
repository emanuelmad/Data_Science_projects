---
title: "An√°lise de Regress√£o"
subtitle: "Laborat√≥rio de Sensoriamento Remoto"
author: "Por Prof. Dr. Emanuel Ara√∫jo Silva"
output:
  html_document:
    df_print: paged
---

## Introdu√ß√£o

A regress√£o linear simples √© utilizada para analisar rela√ß√µes entre vari√°veis cont√≠nuas (KENNEY & KEEPING, 1962). No R, para especificar um modelo √© preciso usar a nota√ß√£o de f√≥rmulas. Por exemplo, para um modelo de regress√£o com uma vari√°vel resposta Y (ou dependente) e uma vari√°vel preditora X (ou independente), a nota√ß√£o de f√≥rmula a ser usada no R √©: Y ~ X. O argumento ~ (til) significa em rela√ß√£o √†. . . ou modelado por. ..(ou seja, Y em rela√ß√£o √† X, ou Y modelado por X). Caso haja duas vari√°veis preditoras no modelo, a f√≥rmula ser√°: Y~X1+X2.
```{r}
# Carrega o pacote data.table para usar a fun√ß√£o fread
library(data.table)
# L√™ o arquivo CSV "Tectona.csv" e armazena em um data.frame chamado 'teca'
teca <- fread("Tectona.csv")
# Imprime o data.frame 'teca' para visualiza√ß√£o
print(teca)
````

## Gr√°ficos de dispers√£o
```{r}
# Anexa o data.frame 'teca' para acessar suas colunas diretamente
attach(teca)
# Plota gr√°fico de dispers√£o para DAP e Volume
plot(DAP, Volume, type = "p", xlab="DAP (cm)", ylab=expression(Volume~(m^3)))
# Plota gr√°fico de dispers√£o para Altura e Volume
plot(H, Volume, type = "p", xlab="Altura (m)", ylab=expression(Volume~(m^3)))
# Desanexa o data.frame 'teca'
detach(teca)
````

Ajustar os seguintes modelos volum√©tricos:
ÔÇ∑ Berkhout: V=Œ≤0+Œ≤1 (DAP)V=Œ≤0+Œ≤1 (DAP)
ÔÇ∑ Kopezky-Gerhardt: V=Œ≤0+Œ≤1 (DAP2)
ÔÇ∑ Schumacher-Hall: lnV=Œ≤0+Œ≤1 (lnDAP)+Œ≤2 (lnH)
```{r}
# Ajuste de modelos
# Ajusta o modelo de regress√£o linear para Berkhout
Berkhout <- lm(Volume ~ DAP, data=teca)
# Ajusta o modelo de regress√£o linear para Kopezky-Gerhardt
KGerhardt <- lm(Volume ~ I(DAP^2), data=teca)
# Ajusta o modelo de regress√£o linear para Schumacher-Hall
SHall <- lm(log(Volume) ~ log(DAP) + log(H), data=teca)
````

Para obter informa√ß√µes mais detalhadas do ajuste pode-se usar a fun√ß√£o summary(). A partir dessa fun√ß√£o, os seguintes valores podem ser observados: Erro-Padr√£o (ùë†ùë•ÃÖ), Estimativas dos Coeficientes de Regress√£o (Valores de ùõΩ), Erro-Padr√£o de Estimativa (ùë†ùë¶ùë•), Coeficiente de Determina√ß√£o (ùëÖ¬≤) e Coeficiente de Determina√ß√£o Ajustado (ùëÖ¬≤ùëéùëó.). Al√©m disso, pode-se visualizar o teste F de signific√¢ncia global e o do(s) teste(s) t-Student para signific√¢ncia do(s) coeficiente(s) da regress√£o.
```{r}
# Resumo dos modelos
# Mostra o resumo estat√≠stico do modelo de Berkhout
summary(Berkhout)
# Mostra o resumo estat√≠stico do modelo de Kopezky-Gerhardt
summary(KGerhardt)
# Mostra o resumo estat√≠stico do modelo de Schumacher-Hall
summary(SHall)
````

A fun√ß√£o anova() permite obter a tabela de ANOVA da Regress√£o:
```{r}
# ANOVA da REGRESS√ÉO
# Obt√©m a tabela de ANOVA para o modelo de Berkhout
anova(Berkhout)
# Obt√©m a tabela de ANOVA para o modelo de Kopezky-Gerhardt
anova(KGerhardt)
# Obt√©m a tabela de ANOVA para o modelo de Schumacher-Hall
anova(SHall)
````

Pode-se visualizar a reta ajustada para o modelo de Berkhout (V=Œ≤0+Œ≤1 (DAP)V=Œ≤0+Œ≤1 (DAP)):
```{r}
# Reta da Regress√£o ajustada
# Mostra a reta ajustada para o modelo de Berkhout
plot(teca$Volume~teca$DAP, main="Berkhout", xlab="DAP (cm)", ylab = expression(Volume~(m^3)))
abline(Berkhout, lty=2, col="red")

# Obt√©m os valores preditos pelo modelo de Berkhout
predict(Berkhout)

# Obt√©m os valores dos res√≠duos do modelo de Berkhout
residuals(Berkhout)
````


An√°lise de Res√≠duos
Os res√≠duos da regress√£o linear devem ser avaliados quanto √†s pressuposi√ß√µes de normalidade, autocorrela√ß√£o e homocedasticidade. O teste para normalidade dos res√≠duos pode ser realizado usado a fun√ß√£o shapiro.test(). A autocorrela√ß√£o pode ser detectada com uso da fun√ß√£o durbinWatsonTest() e a heterocedasticidade dos res√≠duos com a fun√ß√£o Breusch-Pagan().
```{r}
# An√°lise de res√≠duos
# Teste de Shapiro-Wilk para normalidade dos res√≠duos
shapiro.test(Berkhout$residuals)
shapiro.test(KGerhardt$residuals)
shapiro.test(SHall$residuals)

# Teste Durbin-Watson para autocorrela√ß√£o dos res√≠duos
library(car)
durbinWatsonTest(Berkhout)
durbinWatsonTest(KGerhardt)
durbinWatsonTest(SHall)

# Teste Breusch-Pagan para heterocedasticidade dos res√≠duos
library(lmtest)
bptest(Berkhout)
bptest(KGerhardt)
bptest(SHall)


#Plotar gr√°ficos
plot(Berkhout)
plot(KGerhardt)
plot(SHall)
````


A inexist√™ncia de multicolinearidade √© outra importante pressuposi√ß√£o que deve ser analisada em modelos de regress√£o linear m√∫ltipla. O grau de confundimento entre vari√°veis preditoras pode ser verificado por meio da estat√≠stica Variance Inflation Factor ‚Äì (VIF), que detecta problemas de multicolinearidade. √â recorrente o uso de VIF > 10 como crit√©rio para afirmar a exist√™ncia de multicolinearidade no modelo de regress√£o linear m√∫ltipla. Para obter o valor desse √≠ndice, pode-se usar a fun√ß√£o vif() do pacote faraway (FARAWAY, 2016).
```{r}
# Multicolinearidade
# Verifica a multicolinearidade atrav√©s do VIF
library(faraway)
vif(SHall)
````

